{
  "name": "í•œêµ­ ì£¼ì‹ OHLCV ë°ì´í„° ìˆ˜ì§‘",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours",
              "minutesAndSeconds": {
                "minute": 0,
                "second": 0
              },
              "triggerAtHour": [
                18
              ]
            }
          ]
        }
      },
      "id": "3a36e9f9-22df-4cc0-97c7-c923bd8ccc4e",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1,
      "position": [
        250,
        300
      ]
    },
    {
      "parameters": {
        "url": "http://localhost:8000/api/symbols/update",
        "method": "POST",
        "options": {
          "fullResponse": true
        }
      },
      "id": "7c5e1d8a-1b34-4f69-9d83-a2c65f8ab123",
      "name": "ì¢…ëª© ì½”ë“œ ì—…ë°ì´íŠ¸",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 3,
      "position": [
        450,
        300
      ]
    },
    {
      "parameters": {
        "url": "http://localhost:8000/api/collect/today",
        "method": "POST",
        "options": {
          "fullResponse": true
        }
      },
      "id": "cf4df3e3-e0e4-4c6e-8a82-d9ca4fb9f3d1",
      "name": "ì˜¤ëŠ˜ ë°ì´í„° ìˆ˜ì§‘",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 3,
      "position": [
        650,
        300
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.status_code.toString() }}",
              "value2": "200",
              "operation": "equals"
            }
          ]
        }
      },
      "id": "5bc82e85-4e8e-4baa-9b56-a9a4e4e1eddd",
      "name": "IF",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        850,
        300
      ]
    },
    {
      "parameters": {
        "chatId": "{{ $env.TELEGRAM_CHAT_ID }}",
        "text": "âœ… ì£¼ì‹ ë°ì´í„° ìˆ˜ì§‘ ì‘ì—…ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n{{ $json.body.message }}",
        "additionalFields": {
          "parse_mode": "HTML"
        }
      },
      "id": "59d9f9b6-1f85-4b94-a81c-7b2d1e69d2f4",
      "name": "ì„±ê³µ ë©”ì‹œì§€ ì „ì†¡",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        1050,
        200
      ],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "{{ $env.TELEGRAM_CHAT_ID }}",
        "text": "âŒ ì£¼ì‹ ë°ì´í„° ìˆ˜ì§‘ ì‘ì—…ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\n\nì˜¤ë¥˜ ì½”ë“œ: {{ $json.status_code }}\nì˜¤ë¥˜ ë‚´ìš©: {{ $json.statusMessage }}",
        "additionalFields": {
          "parse_mode": "HTML"
        }
      },
      "id": "06dbb1b1-93e8-4e7a-a0a9-b11c4607d1e4",
      "name": "ì‹¤íŒ¨ ë©”ì‹œì§€ ì „ì†¡",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        1050,
        400
      ],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "// í‰ì¼(ì›”-ê¸ˆ)ì¸ì§€ í™•ì¸ - ê°œì„ ëœ ë²„ì „\nconst dateObject = new Date();\nconst dayOfWeek = dateObject.getDay(); // 0:ì¼ ~ 6:í† \nconst isoDate = dateObject.toISOString();\nconst koreanDate = new Date(dateObject.getTime() + (9 * 60 * 60 * 1000)).toISOString(); // UTC+9 ì‹œê°„ìœ¼ë¡œ ë³€í™˜\n\n// ìš”ì¼ ì´ë¦„ (ë””ë²„ê¹…ìš©)\nconst dayNames = ['ì¼ìš”ì¼', 'ì›”ìš”ì¼', 'í™”ìš”ì¼', 'ìˆ˜ìš”ì¼', 'ëª©ìš”ì¼', 'ê¸ˆìš”ì¼', 'í† ìš”ì¼'];\nconst dayName = dayNames[dayOfWeek];\n\n// ì£¼ë§(0:ì¼, 6:í† )ì´ ì•„ë‹Œ ê²½ìš° í™•ì¸\nconst isWeekday = (dayOfWeek >= 1 && dayOfWeek <= 5);\n\n// ë””ë²„ê¹… ì •ë³´ ìƒì„±\nconst debugInfo = {\n  currentDate: isoDate,\n  koreanDate: koreanDate,\n  dayOfWeek: dayOfWeek,\n  dayName: dayName,\n  isWeekday: isWeekday\n};\n\n// n8nì—ì„œ Function ë…¸ë“œëŠ” items ë°°ì—´ì„ ë°˜í™˜í•´ì•¼ í•¨\nreturn items.map(item => {\n  const newItem = JSON.parse(JSON.stringify(item));\n  newItem.json = newItem.json || {};\n  newItem.json.data = isWeekday;\n  newItem.json.debug = debugInfo;\n  return newItem;\n});"
      },
      "id": "a9c50c9c-2b9a-4b59-b4ee-ddea9b23d7c1",
      "name": "í‰ì¼ í™•ì¸",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        350,
        300
      ]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.data }}",
              "value2": true,
              "operation": "equals"
            }
          ]
        }
      },
      "id": "a3eba7c4-5a5e-4fcd-aead-f84d9a1cf8ac",
      "name": "IF1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        450,
        100
      ]
    },
    {
      "parameters": {
        "url": "http://localhost:8000/api/merge",
        "method": "POST",
        "options": {
          "fullResponse": true
        }
      },
      "id": "f9c2dc3a-e4c7-4a29-bc98-eb6a13eec8f4",
      "name": "ë°ì´í„° ë³‘í•© ìš”ì²­",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 3,
      "position": [
        1250,
        200
      ]
    },
    {
      "parameters": {
        "chatId": "{{ $env.TELEGRAM_CHAT_ID }}",
        "text": "ğŸ“Š ì£¼ì‹ ë°ì´í„°ê°€ ì˜¤ëŠ˜ ìˆ˜ì§‘ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\nì´ìœ : í‰ì¼ ê²€ì‚¬ ê²°ê³¼ê°€ falseì…ë‹ˆë‹¤.\n\n[ë””ë²„ê¹… ì •ë³´]\në‚ ì§œ(UTC): {{ $json.debug.currentDate }}\në‚ ì§œ(í•œêµ­): {{ $json.debug.koreanDate }}\nìš”ì¼: {{ $json.debug.dayName }} ({{ $json.debug.dayOfWeek }})\ní‰ì¼ ì—¬ë¶€: {{ $json.debug.isWeekday }}",
        "additionalFields": {
          "parse_mode": "HTML"
        }
      },
      "id": "c3b9b2ac-db5d-4e0a-9b8e-65ac9a0afbec",
      "name": "ì£¼ë§ ì•Œë¦¼ ì „ì†¡",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        650,
        100
      ],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "{{ $env.TELEGRAM_CHAT_ID }}",
        "text": "ğŸ“Š ë°ì´í„° ë³‘í•© ì™„ë£Œ: {{ $json.body.message }}",
        "additionalFields": {
          "parse_mode": "HTML"
        }
      },
      "id": "d5b9c3e7-2a98-4bd1-b7fa-3c76d8e94a12",
      "name": "ë³‘í•© ì™„ë£Œ ì•Œë¦¼",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        1450,
        200
      ],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.body.status }}",
              "value2": "success",
              "operation": "equals"
            }
          ]
        }
      },
      "id": "symbol-update-check",
      "name": "ì¢…ëª© ì½”ë“œ ì—…ë°ì´íŠ¸ í™•ì¸",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        550,
        300
      ]
    },
    {
      "parameters": {
        "chatId": "{{ $env.TELEGRAM_CHAT_ID }}",
        "text": "âŒ ì¢…ëª© ì½”ë“œ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨\n\nìƒíƒœ: {{ $json.body.status || 'unknown' }}\nì˜¤ë¥˜ ë‚´ìš©: {{ $json.body.detail || $json.body.message || $json.statusMessage || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜' }}",
        "additionalFields": {
          "parse_mode": "HTML"
        }
      },
      "id": "symbol-update-error",
      "name": "ì¢…ëª© ì½”ë“œ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨ ì•Œë¦¼",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        650,
        450
      ],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.body.status }}",
              "value2": "success",
              "operation": "equals"
            }
          ]
        }
      },
      "id": "merge-check",
      "name": "ë³‘í•© ê²°ê³¼ í™•ì¸",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        1350,
        200
      ]
    },
    {
      "parameters": {
        "chatId": "{{ $env.TELEGRAM_CHAT_ID }}",
        "text": "âš ï¸ ë°ì´í„° ë³‘í•© ê²½ê³ : {{ $json.body.message }}",
        "additionalFields": {
          "parse_mode": "HTML"
        }
      },
      "id": "merge-warning",
      "name": "ë³‘í•© ê²½ê³  ì•Œë¦¼",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [
        1450,
        350
      ],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram account"
        }
      }
    }
  ],
  "connections": {
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "í‰ì¼ í™•ì¸",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì˜¤ëŠ˜ ë°ì´í„° ìˆ˜ì§‘": {
      "main": [
        [
          {
            "node": "IF",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF": {
      "main": [
        [
          {
            "node": "ì„±ê³µ ë©”ì‹œì§€ ì „ì†¡",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ì‹¤íŒ¨ ë©”ì‹œì§€ ì „ì†¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì„±ê³µ ë©”ì‹œì§€ ì „ì†¡": {
      "main": [
        [
          {
            "node": "ë°ì´í„° ë³‘í•© ìš”ì²­",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ë°ì´í„° ë³‘í•© ìš”ì²­": {
      "main": [
        [
          {
            "node": "ë³‘í•© ê²°ê³¼ í™•ì¸",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "í‰ì¼ í™•ì¸": {
      "main": [
        [
          {
            "node": "IF1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF1": {
      "main": [
        [
          {
            "node": "ì¢…ëª© ì½”ë“œ ì—…ë°ì´íŠ¸",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ì£¼ë§ ì•Œë¦¼ ì „ì†¡",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì¢…ëª© ì½”ë“œ ì—…ë°ì´íŠ¸": {
      "main": [
        [
          {
            "node": "ì¢…ëª© ì½”ë“œ ì—…ë°ì´íŠ¸ í™•ì¸",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ì¢…ëª© ì½”ë“œ ì—…ë°ì´íŠ¸ í™•ì¸": {
      "main": [
        [
          {
            "node": "ì˜¤ëŠ˜ ë°ì´í„° ìˆ˜ì§‘",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ì¢…ëª© ì½”ë“œ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨ ì•Œë¦¼",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ë³‘í•© ê²°ê³¼ í™•ì¸": {
      "main": [
        [
          {
            "node": "ë³‘í•© ì™„ë£Œ ì•Œë¦¼",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ë³‘í•© ê²½ê³  ì•Œë¦¼",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}